# -
条形码识别操作工具

简介：通过外设输入条形码进行相对应查找日志文件，对工厂的日志生产文件进行自动判断

1.业务流程

  比对两个条形码对应两个文件，文件名里的两个条形码和文件内容里的First barcode、Second barcode是否相同
  
  判断两个文件倒数第三或第四行的Test Suite是否为Pass
  
  将对应文件移动到对应的成功或失败文件路径
  存储操作记录到SQL SERVER数据库
  在管理员界面可进行查询历史记录
  在管理员界面可将数据导出成Excel文件

2.开发工具
  C#、Winform、SQL SERVER数据库

3.详细开发流程

a.文件名和文件内容的条形码判断 和  两个文件内容的Test Suite是否通过
  注意：有些文件很大，几百k。所以不再能使用根据指定位置截取这种方法，所以需要重新找一种思路。能够动态的获取字符的位置。
  使用for循环遍历数组，实例化FileStream对象，打开对应路径的文件
  选定多少个字符为一组输出
  用while循环和fs.Read(b, 0, b.Length)方法遍历文件内容
  将所有文本内容存进一个字符串中
  使用LastIndexOf 方法获取字符串里 "Test Suite: "的位置
  然后使用Substring 方法截取文本出来，参数是位置和截取长度
  判断截取出来的文本是否通过

b.移动判断通过的文件
  根据实际情况将文件的路径分为两部分，前面部分是文件夹路径，后面部分是文件名。
  首先要获取所有的后面部分的文件名，于是定义字符串数组，使用Split方法截取出来。
  接着要合成完整的移动目标路径文件，定义字符串数组，遍历数组将目标的文件夹名和后面部分的文件名拼接起来
  用 flag_total 全局变量判断是否通过，若通过则进行移动操作，使用 Fil e.Move(dirs[i], sum_Array[i]) 方法将成功通过的文件进行移动

c.存储记录
  创建数据库FileOperate
  数据库连接和编写操作类Dao
  数据库创建record表，参数为条形码1，条形码2，时间，结果
  在Form1窗体中，使用 flag_sql 全局变量来判断存储成功记录还是失败记录。
  定义sql语句，语句是插入的insert into
  实例化Dao类，使用Dao的Execute方法进行操作

d.查询检测记录
  在Select 窗体中，定义SQL的查询语句
  实例化Dao类，使用Read方法进行数据读取，将数据渲染到dataGridView1表格中
  查询通过个数：SQL语句是select count查询语句，实例化Dao类，使用Read方法进行数据读取，将数据存到TextBox中

e.使用NPOI库
  参考 https://www.cnblogs.com/duhaoran/p/13677732.html

优化：
右上角增加设置模块，进入需要密码（admin），路径设置功能放在这个模块里面，路径数据要传到Form1
主页面左边增加结果显示部分，显示结果要大，包括结果、背景颜色（红绿色）
主页面右边放判断数量，右下放框信息

发布：
图标32位不清晰。48和64位显示不了
